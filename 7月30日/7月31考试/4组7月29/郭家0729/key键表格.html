<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <style>
        body{
            font-size: 20px;
        }
        table{
            border-collapse: collapse;
        }
        table tr:nth-child(2n){
             background-color: #c4ffe9;
         }
        table tr:nth-child(2n+1){
            background-color: #f5ffdd;
        }
        table tr td{
            width: 250px;
            height: 45px;
            border: 1px solid lightgrey;
            text-align: center;
        }
    </style>

</head>
<body>
<table id="table01">
    <tr STYLE="background-color: #00b4f8">
        <td>货币</td>
        <td>本周收盘</td>
        <td>上周收盘</td>
        <td>涨跌</td>
        <td>幅度</td>
    </tr>
    <tr ondblclick="chg(this)" onblur="save(this)">
       <td>1111EURGBP</td>
        <td>0.8693</td>
        <td>0.8894</td>
        <td>-201</td>
        <td>-2.31%</td>
    </tr>
    <tr ondblclick="chg(this)" onblur="save(this)">
        <td>22222EURGBP</td>
        <td>0.8693</td>
        <td>0.8894</td>
        <td>-201</td>
        <td>-2.31%</td>
    </tr>
    <tr ondblclick="chg(this)" onblur="save(this)">
        <td>333333EURGBP</td>
        <td>0.8693</td>
        <td>0.8894</td>
        <td>-201</td>
        <td>-2.31%</td>
    </tr>
    <tr ondblclick="chg(this)" onblur="save(this)">
        <td>4444444EURGBP</td>
        <td>0.8693</td>
        <td>0.8894</td>
        <td>-201</td>
        <td>-2.31%</td>
    </tr>
    <tr onblur="save(this)">
        <td>55555EURGBP</td>
        <td>0.8693</td>
        <td>0.8894</td>
        <td>-201</td>
        <td>-2.31%</td>
    </tr>
</table>
<input type="button" value="删除" onclick="del()">
</body>
</html>
<script>
    var tab01=document.getElementById('table01');
    var tr01=tab01.rows;
    function fun01(e){
//                 e= e.parentNode
        var src= e.srcElement||e.target;
//                    var n= v.rowIndex;
        src.parentNode.style.backgroundColor='red';
    }
    function fun02(e){
//                 e= e.parentNode
        var src= e.srcElement||e.target;
//                    var n= v.rowIndex;
        src.parentNode.style.backgroundColor='green';
    }
    function chg(v){
        v=v||window.e;
        var n= v.rowIndex;
        for(var i=0;i<5;i++){
            var x=tr01[n].cells[i].innerText;
            tr01[n].cells[i].innerHTML="<input type='text'value='"+x+"'>"
        }
    }
    function  save(v){
        v=v||window.e;
        var n= v.rowIndex;
        for(var i=0;i<5;i++){
            var b=tr01[n].cells[i].children[0].value;
            tr01[n].cells[i].innerHTML=b;
        }
    }
    document.onkeydown=function(e){
        e=e||window.e;
        if(e.ctrlKey){
//            alert('up')
//            for(var i=1;i<tr01.length;i++){
            tr01[1].addEventListener('click',fun01,false);
            tr01[2].addEventListener('click',fun01,false);
            tr01[3].addEventListener('click',fun01,false);
            tr01[4].addEventListener('click',fun01,false);
            tr01[5].addEventListener('click',fun01,false);


//                for(var i=0;i<5;i++){
//                    var x=tr01[n].cells[i].innerText;
//                    tr01[n].cells[i].innerHTML="<input type='text'value='"+x+"'>"
//                }
//            }

        }

//       }
    }

    document.onkeyup=function(e) {
        e = e || window.e;
        if(e.altKey){
            tr01[1].addEventListener('click',fun02,false);
            tr01[2].addEventListener('click',fun02,false);
            tr01[3].removeEventListener('click',fun02,false);
            tr01[4].removeEventListener('click',fun02,false);
            tr01[5].removeEventListener('click',fun02,false);
        }
    }

    function del(){
        for(var i=0;i<tr01.length;i++){
            if(tr01[i].style.backgroundColor=="red"){
                tab01.deleteRow(i);
                i--;
            }
        }
    }
</script>